# Serial Studio VSCode 插件 - 脚本使用说明

## 概述

本项目提供了两个重要的自动化脚本，用于简化开发和调试流程：

- **`build.sh`** - 构建和打包脚本
- **`debug.sh`** - 调试环境配置脚本

## 🔨 构建脚本 (build.sh)

### 主要功能

构建脚本提供了完整的项目构建、测试、打包和部署功能。

### 基本用法

```bash
./build.sh <command>
```

### 可用命令

#### 构建命令
- `build` - 完整构建扩展（推荐）
- `build-install` - 构建并自动安装到 VSCode
- `compile` - 仅编译 TypeScript 代码
- `package` - 仅打包扩展为 .vsix 文件
- `install` - 安装已构建的扩展到 VSCode

#### 开发命令
- `dev` - 启动开发模式（文件监听）
- `test` - 运行完整测试套件
- `test-unit` - 运行单元测试
- `test-perf` - 运行性能测试
- `coverage` - 生成测试覆盖率报告
- `lint` - 运行 ESLint 代码检查
- `typecheck` - 运行 TypeScript 类型检查

#### 清理命令
- `clean` - 清理构建文件和项目缓存
- `clean-vscode` - 清理 VSCode 全局缓存
- `deep-clean` - 深度清理（包括 node_modules）

#### 信息命令
- `info` - 显示项目详细信息
- `help` - 显示帮助信息

### 使用示例

```bash
# 完整构建并安装
./build.sh build-install

# 开发模式
./build.sh dev

# 运行测试并生成覆盖率报告
./build.sh test
./build.sh coverage

# 清理项目
./build.sh clean

# 查看项目信息
./build.sh info
```

### 构建流程

`build` 命令会执行以下步骤：

1. ✅ 检查开发环境依赖
2. ✅ 验证项目文件结构
3. ✅ 安装 npm 依赖
4. ✅ 运行 TypeScript 类型检查
5. ✅ 运行 ESLint 代码检查
6. ✅ 编译 TypeScript 代码
7. ✅ 使用 Webpack 打包
8. ✅ 生成 .vsix 扩展包

## 🐛 调试脚本 (debug.sh)

### 主要功能

调试脚本用于快速搭建开发调试环境，配置 VSCode 调试设置。

### 基本用法

```bash
./debug.sh [command]
```

### 可用命令

- `（无参数）` - 搭建完整调试环境
- `stop` - 停止后台监听服务
- `restart` - 重启 TypeScript 监听编译
- `status` - 显示调试环境状态
- `clean` - 清理调试配置文件
- `help` - 显示帮助信息

### 使用示例

```bash
# 搭建调试环境
./debug.sh

# 查看状态
./debug.sh status

# 停止后台服务
./debug.sh stop

# 重启监听编译
./debug.sh restart

# 清理调试配置
./debug.sh clean
```

### 调试环境搭建

运行 `./debug.sh` 会自动完成：

1. ✅ 检查开发环境（Node.js, npm）
2. ✅ 安装项目依赖
3. ✅ 创建 VSCode 调试配置文件：
   - `.vscode/launch.json` - 调试启动配置
   - `.vscode/tasks.json` - 构建任务配置
   - `.vscode/settings.json` - 项目设置
   - `.vscode/extensions.json` - 推荐扩展
4. ✅ 执行初始编译
5. ✅ 启动 TypeScript 监听编译
6. ✅ 可选运行代码检查和测试

### 调试配置说明

创建的调试配置包括：

- **🚀 运行扩展** - 基础调试模式（推荐日常使用）
- **🔧 完整开发模式** - 包含其他扩展的完整环境
- **🧪 运行扩展测试** - 运行扩展测试套件
- **🎯 Worker 调试** - 调试数据处理 Worker

### 调试步骤

1. 运行调试脚本：
   ```bash
   ./debug.sh
   ```

2. 在 VSCode 中按 `F5` 或 `Ctrl+Shift+D` 打开调试面板

3. 选择调试配置并启动

## 🌟 项目特色功能

### Serial Studio 插件功能
- 串口数据实时可视化
- 支持多种数据格式解析
- 图表和仪表盘显示
- 数据导出功能（CSV, JSON, Excel, XML）
- MQTT 数据源支持
- 高性能数据处理

### 脚本特色功能
- 🎯 自动化构建流程
- 🔧 一键调试环境搭建
- 📊 完整的测试和覆盖率报告
- 🧹 智能缓存清理
- 📱 友好的交互界面
- 🚀 支持开发和生产模式

## 🔧 环境要求

### 必需软件
- **Node.js** >= 18.0.0
- **npm** >= 8.0.0
- **VSCode** >= 1.74.0

### 推荐安装的 VSCode 扩展
- Vue Language Features (Volar)
- TypeScript Importer
- Prettier - Code formatter
- ESLint
- Test Adapter Converter

## 📁 项目结构

```
vscode-externsion-serial/
├── build.sh                 # 构建脚本
├── debug.sh                 # 调试脚本
├── src/                     # 源代码
│   ├── extension/           # 扩展后端代码
│   ├── webview/            # 前端视图代码
│   ├── shared/             # 共享模块
│   └── workers/            # 数据处理 Workers
├── utest/                  # 单元测试（已排除出构建）
├── dist/                   # Webpack 输出
├── out/                    # TypeScript 输出
└── .vscode/               # VSCode 配置（调试脚本生成）
```

## 🚨 常见问题

### Q: 编译错误怎么办？
A: 先运行类型检查和代码检查：
```bash
./build.sh typecheck
./build.sh lint
```

### Q: 调试无法启动？
A: 检查调试环境状态：
```bash
./debug.sh status
```
如果配置缺失，重新运行：
```bash
./debug.sh clean
./debug.sh
```

### Q: 如何清理项目？
A: 根据需要选择清理级别：
```bash
./build.sh clean          # 基础清理
./build.sh clean-vscode   # VSCode 缓存清理
./build.sh deep-clean     # 深度清理
```

### Q: 测试失败怎么办？
A: 逐步检查：
```bash
./build.sh test-unit      # 单元测试
./build.sh coverage       # 查看覆盖率
```

## 📞 技术支持

如果在使用过程中遇到问题：

1. 查看脚本帮助：`./build.sh help` 或 `./debug.sh help`
2. 检查项目状态：`./build.sh info`
3. 查看日志文件：`tail -f watch.log`
4. 重新初始化环境：`./debug.sh clean && ./debug.sh`

---

**提示**：建议将这两个脚本加入你的日常开发工作流中，可以大大提升开发效率！