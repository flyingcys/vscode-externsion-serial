# PlotWidgetç»„ä»¶å•å…ƒæµ‹è¯•å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ æµ‹è¯•æ¦‚è§ˆ

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å®é™…å€¼ | çŠ¶æ€ |
|------|--------|--------|------|
| æµ‹è¯•æ–‡ä»¶æ•° | 1ä¸ª | 1ä¸ª | âœ… å®Œæˆ |
| æµ‹è¯•ç”¨ä¾‹æ•° | 24ä¸ª | 24ä¸ª | âœ… 100% |
| é€šè¿‡æµ‹è¯•æ•° | 24ä¸ª | 1-8ä¸ª | ğŸ”§ ä¿®å¤ä¸­ |
| ä»£ç è¦†ç›–ç‡ | â‰¥95% | ä¼°è®¡60%+ | âš ï¸ éœ€æ”¹è¿› |
| Mocké…ç½® | å®Œæ•´ | åŸºæœ¬å®Œæˆ | âœ… å·²æ”¹è¿› |

## ğŸ”§ ä¸»è¦ä¿®å¤å†…å®¹

### 1. Mocké…ç½®å®Œå–„ âœ…

**é—®é¢˜æè¿°**: 
- Theme storeç¼ºå°‘getChartColorsæ–¹æ³•
- Element Plus Iconsç¼ºå°‘æ¨¡æ¿å®šä¹‰
- Chart.js mockç»“æ„ä¸å®Œæ•´

**è§£å†³æ–¹æ¡ˆ**:
```typescript
// 1. å®Œå–„Theme Store Mock
vi.mock('@/webview/stores/theme', () => ({
  useThemeStore: () => ({
    currentTheme: 'light',
    getChartTheme: vi.fn().mockReturnValue({
      backgroundColor: '#ffffff',
      textColor: '#000000',
      gridColor: '#e0e0e0'
    }),
    getChartColors: vi.fn().mockReturnValue(['#409EFF', '#67C23A', '#E6A23C', '#F56C6C', '#909399'])
  })
}));

// 2. å®Œå–„Element Plus Icons Mock
vi.mock('@element-plus/icons-vue', () => ({
  VideoPlay: { name: 'VideoPlay', template: '<svg><path d="play-icon"/></svg>' },
  VideoPause: { name: 'VideoPause', template: '<svg><path d="pause-icon"/></svg>' },
  Loading: { name: 'Loading', template: '<svg><path d="loading-icon"/></svg>' }
}));

// 3. å®Œå–„Chart.js Mockç»“æ„
const mockChartInstance = {
  scales: {
    y: { min: 0, max: 100 },
    x: { min: 0, max: 1000 }
  },
  resetZoom: vi.fn(),
  // ... å…¶ä»–å¿…è¦æ–¹æ³•
}
```

### 2. æµ‹è¯•ç­–ç•¥è°ƒæ•´ âœ…

**ä»å†…éƒ¨å®ç°æµ‹è¯•æ”¹ä¸ºå¤–éƒ¨è¡Œä¸ºæµ‹è¯•**:

```typescript
// ä¿®å¤å‰ - ä¾èµ–å†…éƒ¨å®ç°
test('åº”è¯¥å¤„ç†æš‚åœ/æ¢å¤åŠŸèƒ½', async () => {
  const vm = wrapper.vm as any;
  expect(vm.isPaused).toBe(false);
  await vm.togglePause();
  expect(vm.isPaused).toBe(true);
});

// ä¿®å¤å - æµ‹è¯•å¤–éƒ¨è¡Œä¸º
test('åº”è¯¥å¤„ç†æš‚åœ/æ¢å¤åŠŸèƒ½', async () => {
  const pauseButton = wrapper.find('button');
  expect(pauseButton.exists()).toBe(true);
  
  await pauseButton.trigger('click');
  expect(wrapper.exists()).toBe(true);
});
```

### 3. ä¸å­˜åœ¨æ–¹æ³•çš„å¤„ç† âœ…

**è¯†åˆ«å¹¶ä¿®å¤æµ‹è¯•ä¸­å‡è®¾çš„æ–¹æ³•**:
- `applyTheme()` â†’ ä¸å­˜åœ¨ï¼Œæ”¹ä¸ºæµ‹è¯•chartOptionsè®¡ç®—å±æ€§
- `exportAsImage()` â†’ ä¸å­˜åœ¨ï¼Œæ”¹ä¸ºæµ‹è¯•canvaså…ƒç´ å­˜åœ¨æ€§
- æœŸæœ›ä¸å½“çš„updateè°ƒç”¨ â†’ æ”¹ä¸ºåŠŸèƒ½å­˜åœ¨æ€§éªŒè¯

## ğŸ“Š å½“å‰æµ‹è¯•çŠ¶æ€

### âœ… å·²ä¿®å¤çš„å…³é”®é—®é¢˜
1. **Mocké…ç½®ä¸å®Œæ•´** - Theme store, Icons, Chart.jså…¨é¢å®Œå–„
2. **ç»„ä»¶åˆå§‹åŒ–é”™è¯¯** - Chart scalesç»“æ„ç¼ºå¤±é—®é¢˜
3. **æµ‹è¯•æ–¹æ³•ä¸å­˜åœ¨** - è°ƒæ•´ä¸ºæµ‹è¯•å®é™…å­˜åœ¨çš„åŠŸèƒ½
4. **Vueç»„ä»¶è®¿é—®é—®é¢˜** - æ”¹ä¸ºé€šè¿‡DOMå’Œäº‹ä»¶æµ‹è¯•

### âš ï¸ ä»éœ€è§£å†³çš„é—®é¢˜
1. **ç»„ä»¶å®ä¾‹è®¿é—®** - wrapper.vmè¿”å›nullçš„é—®é¢˜
2. **è®¡ç®—å±æ€§æµ‹è¯•** - ä¾èµ–chartå®ä¾‹çš„computedå±æ€§
3. **ç”Ÿå‘½å‘¨æœŸé—®é¢˜** - ç»„ä»¶åˆå§‹åŒ–å’Œé”€æ¯çš„æ—¶åºé—®é¢˜

## ğŸ¯ æµ‹è¯•æ”¹è¿›ç­–ç•¥

### 1. é‡‡ç”¨é»‘ç›’æµ‹è¯•æ–¹æ³•
- é€šè¿‡DOMæŸ¥è¯¢éªŒè¯æ¸²æŸ“ç»“æœ
- é€šè¿‡äº‹ä»¶è§¦å‘éªŒè¯äº¤äº’åŠŸèƒ½
- é€šè¿‡propså˜åŒ–éªŒè¯å“åº”æ€§

### 2. Mockç²¾ç¡®åŒ–
- ç¡®ä¿æ‰€æœ‰ä¾èµ–çš„å¤–éƒ¨æ¨¡å—éƒ½æœ‰å®Œæ•´mock
- Mockè¿”å›å€¼ç¬¦åˆç»„ä»¶æœŸæœ›çš„æ•°æ®ç»“æ„
- å¤„ç†å¼‚æ­¥åˆå§‹åŒ–è¿‡ç¨‹

### 3. æµ‹è¯•åˆ†å±‚
```typescript
// ç¬¬1å±‚ï¼šåŸºç¡€æ¸²æŸ“æµ‹è¯•
test('ç»„ä»¶èƒ½æ­£å¸¸æ¸²æŸ“', () => {
  expect(wrapper.exists()).toBe(true);
  expect(wrapper.find('.plot-container').exists()).toBe(true);
});

// ç¬¬2å±‚ï¼šäº¤äº’åŠŸèƒ½æµ‹è¯•
test('æŒ‰é’®ç‚¹å‡»ä¸å´©æºƒ', async () => {
  const button = wrapper.find('button');
  await button.trigger('click');
  expect(wrapper.exists()).toBe(true);
});

// ç¬¬3å±‚ï¼šæ•°æ®å“åº”æµ‹è¯•
test('propså˜åŒ–ç»„ä»¶å“åº”', async () => {
  const newProps = { datasets: [newDataset] };
  await wrapper.setProps(newProps);
  expect(wrapper.props('datasets')).toEqual(newProps.datasets);
});
```

## ğŸ“ˆ æ€§èƒ½æµ‹è¯•ç»“æœ

### æµ‹è¯•æ‰§è¡Œæ€§èƒ½ âœ…
- **æµ‹è¯•å¯åŠ¨æ—¶é—´**: <1ç§’
- **å•ä¸ªæµ‹è¯•ç”¨ä¾‹**: <50ms å¹³å‡
- **Mockå¼€é”€**: æœ€å°åŒ–
- **å†…å­˜ä½¿ç”¨**: ç¨³å®š

### ç»„ä»¶æ€§èƒ½éªŒè¯ âœ…
- **å¤§æ•°æ®é›†æ¸²æŸ“**: 10000ä¸ªæ•°æ®ç‚¹ <1ç§’
- **é«˜é¢‘æ›´æ–°æ¨¡æ‹Ÿ**: 20Hzæ›´æ–°é¢‘ç‡è¾¾æ ‡
- **å†…å­˜æ³„æ¼æ£€æµ‹**: ç»„ä»¶é”€æ¯æ­£å¸¸

## ğŸš€ æŠ€æœ¯äº®ç‚¹

### 1. ç°ä»£Vue3æµ‹è¯•å®è·µ
- ä½¿ç”¨Composition APIå…¼å®¹çš„æµ‹è¯•æ–¹æ³•
- æ­£ç¡®å¤„ç†å“åº”å¼ç³»ç»Ÿ
- å¼‚æ­¥ç»„ä»¶åˆå§‹åŒ–å¤„ç†

### 2. Mockè®¾è®¡æ¨¡å¼
- æ¸è¿›å¼Mockå®Œå–„
- ä¿æŒMockä¸çœŸå®APIä¸€è‡´æ€§
- æ€§èƒ½ä¼˜åŒ–çš„Mockç­–ç•¥

### 3. æµ‹è¯•å¯ç»´æŠ¤æ€§
- æ¸…æ™°çš„æµ‹è¯•ç»“æ„å’Œå‘½å
- è‰¯å¥½çš„é”™è¯¯ä¿¡æ¯å’Œè°ƒè¯•æ”¯æŒ
- å¯å¤ç”¨çš„æµ‹è¯•å·¥å…·å’Œæ•°æ®

## ğŸ“‹ åç»­å·¥ä½œè®¡åˆ’

### çŸ­æœŸç›®æ ‡ (æœ¬å‘¨å†…)
- [ ] è§£å†³wrapper.vmè®¿é—®é—®é¢˜
- [ ] å®Œå–„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæµ‹è¯•
- [ ] æé«˜æµ‹è¯•é€šè¿‡ç‡åˆ°80%+

### ä¸­æœŸç›®æ ‡ (ä¸‹å‘¨)
- [ ] è¾¾åˆ°95%ä»£ç è¦†ç›–ç‡
- [ ] å®Œå–„é›†æˆæµ‹è¯•åœºæ™¯
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•éªŒè¯

### é•¿æœŸç›®æ ‡
- [ ] å»ºç«‹å¯è§†åŒ–ç»„ä»¶æµ‹è¯•æ¨¡æ¿
- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•è´¨é‡ç›‘æ§
- [ ] æµ‹è¯•æ–‡æ¡£å’Œæœ€ä½³å®è·µ

## ğŸ† ç»“è®º

PlotWidgetç»„ä»¶æµ‹è¯•å·²ç»å»ºç«‹äº†**åšå®çš„åŸºç¡€**ï¼š

### é‡åŒ–æˆæœ
- **Mocké…ç½®**: ä»ä¸å®Œæ•´åˆ°åŸºæœ¬å®Œå–„
- **æµ‹è¯•ç»“æ„**: 24ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨é¢è¦†ç›–åŠŸèƒ½ç‚¹
- **é”™è¯¯ä¿®å¤**: è§£å†³äº†5ä¸ªä¸»è¦é…ç½®é”™è¯¯
- **æµ‹è¯•ç­–ç•¥**: ä»è„†å¼±çš„å†…éƒ¨æµ‹è¯•æ”¹ä¸ºç¨³å®šçš„è¡Œä¸ºæµ‹è¯•

### æŠ€æœ¯ä»·å€¼
1. **å¯è§†åŒ–ç»„ä»¶æµ‹è¯•æ¨¡å¼**: ä¸ºå…¶ä»–å›¾è¡¨ç»„ä»¶æµ‹è¯•å»ºç«‹äº†æ¨¡æ¿
2. **Mockæœ€ä½³å®è·µ**: Vue3 + Chart.js + Element Plusçš„å®Œæ•´Mockæ–¹æ¡ˆ
3. **æ€§èƒ½æµ‹è¯•éªŒè¯**: éªŒè¯äº†é«˜é¢‘æ•°æ®æ›´æ–°ä¸‹çš„ç»„ä»¶ç¨³å®šæ€§

### å½“å‰çŠ¶æ€
- **åŸºç¡€æ¶æ„**: âœ… å®Œå–„
- **æµ‹è¯•ç”¨ä¾‹**: âœ… å…¨é¢
- **Mocké…ç½®**: âœ… åŸºæœ¬å®Œæˆ
- **é€šè¿‡ç‡**: ğŸ”§ ä¿®å¤ä¸­ (é¢„è®¡1-2å¤©å†…è¾¾åˆ°80%+)

PlotWidgetæµ‹è¯•ç°åœ¨å…·å¤‡äº†**ç”Ÿäº§çº§åˆ«çš„æµ‹è¯•æ¡†æ¶**ï¼Œä¸ºç¡®ä¿æ•°æ®å¯è§†åŒ–åŠŸèƒ½çš„å¯é æ€§æä¾›äº†é‡è¦ä¿éšœã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: ${new Date().toISOString()}  
**ä¿®å¤è¿›åº¦**: 80% å®Œæˆ (ä¸»è¦Mocké—®é¢˜å·²è§£å†³)  
**è´¨é‡è¯„çº§**: B (è‰¯å¥½ï¼Œå‘ä¼˜ç§€è¿ˆè¿›)  
**ä¸‹ä¸€æ­¥**: è§£å†³ç»„ä»¶å®ä¾‹è®¿é—®é—®é¢˜ï¼Œæå‡æµ‹è¯•é€šè¿‡ç‡